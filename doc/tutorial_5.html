<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/transitional.dtd">
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="description" CONTENT="SparForte language documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>SparForte - Tutorials - Script Tutorial 2: Intermediate Program Scripts</title>
        <link rel="StyleSheet" type="text/css" media="screen" href="art/sparforte.css">
</head>
<body bgcolor="#FFFFFF"><a name="top"></a>
	<table width="100%" cellspacing="0" cellpadding="0" summary="page layout">
		<tr><td align="left"><img src="art/sparforte.png" alt="[SparForte]"></td><td align="right"><img src="art/header_cloud.png" alt="[Banner]"></td></tr>
		<tr><td background="art/header_border.png" height="10" colspan="2"></td></tr>
		<tr><td colspan="2"><table width="100%" border="0" cellspacing="0" cellpadding="0" summary="top menu">
			<tr>
				<td width="10"><img src="art/menu_left.png" alt="[Top Main Menu]"></td>
				<td width="85" background="art/menu_border.png" align="center"><a class="menutext" href="intro_preface.html">Intro</a></td>
				<td background="art/menu_border.png" align="center"><span class="menutext">|</span></td>
				<td width="85" background="art/menu_border.png" align="center"><a class="menutext" href="tutorial_1.html"><b>Tutorials</b></a></td>
				<td background="art/menu_border.png" align="center"><span class="menutext">|</span></td>
				<td width="85" background="art/menu_border.png" align="center"><a class="menutext" href="ref_adascript.html">Reference</a></td>
				<td background="art/menu_border.png" align="center"><span class="menutext">|</span></td>
				<td width="85" background="art/menu_border.png" align="center"><a class="menutext" href="packages.html">Packages</a></td>
				<td background="art/menu_border.png" align="center"><span class="menutext">|</span></td>
				<td width="85" background="art/menu_border.png" align="center"><a class="menutext" href="../examples/index.html">Examples</a></td>
				<td background="art/menu_border.png" align="center"><span class="menutext">|</span></td>
				<td width="85" background="art/menu_border.png" align="center"><a class="menutext" href="cont_vision.html">Contributors</a></td>
				<td background="art/menu_border.png" align="center">&nbsp;</td>
				<td background="art/menu_border.png" align="right"><a href="tutorial_4.html"><img src="art/left_arrow.png" width="27" height="24" alt="[Back Page]" border="0"></a><span class="menutext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="tutorial_14.html"><img src="art/right_arrow.png" width="27" height="24" alt="[Next Page]" border="0"></a></td>
				<td background="art/menu_border.png">&nbsp;</td>
</tr></table></td></tr>
	</table>
	<noscript>
	<a href="#submenu">[Jump to Submenu]</a>
	<hr />
	</noscript>
	<table width="100%" border="0" cellspacing="0" cellpadding="0" summary="content and right submenu">
		<tr>
			<td align="left" valign="top">
				<!-- Content Area -->

<h2><a name="2.5"></a>Script Tutorial 2: Intermediate Program Scripts</h2>

<p>The first script tutorial showed how to write a basic script.  This
tutorial discusses how execute statements and declarations can be
organized.  It also discusses how scripts can evolve and grow under
SparForte.</p>

<h3>What Makes an Error?</h3>

<p>Unlike most programming languages, SparForte takes into account many
factors before reporting an error in a program.</p>

<img src="pictures/sparforte_error_considerations.png" width="742" height="412" alt="[image of 5 considerations]">

<ul>
<li><b>Life cycle stage</b>: Is this script being designed? Developed? Tested?</li>
<li><b>Formality</b>: Is the script structured or unstructured?</li>
<li><b>Project tasks</b>: Is there outstanding work?</li>
<li><b>Architecture</b>: Are there design requirements, standards or restrictions?</li>
<li><b>Software model</b>: Is the script built to standards for a common task?</li>
</ul>

<p>For example, if you declare a variable but do not use it, it may be
considered an error in certain contexts and not an error in others.</p>

<h3>Setting Your Architecture Constraints</h3>

<p>If you are working in a medium to large size organization, you may have
to work with architects and system administrators.  Before starting your
SparForte project, you can work with them to setup global architectural
policy and configuration files.</p>

<p>The global policy file is named "/etc/sparforte_policy".  This file
is for the architects.  It only runs for scripts, and it contains pragmas
(interpreter directives) that will apply to all projects on the server.</p>

<p>The global configuration file is named "/etc/sparforte_config".  This
file is for system administrators.  It only runs for scripts and it contains
declarations of system resources that will apply to all projects on a
server.</p>

<p>For example, if you are working in a company that uses the Ada
programming language a lot, you may want to make all SparForte scripts
conform as closely as possible to Ada to make it easier to reuse program
code.  You could make that a global policy by putting <code>pragma ada_95</code>
into the global policy file.</p>

        <center>
        <div class="code">
        <p class="code"><b>policy</b> my_policy <b>is</b><br>
        &nbsp;&nbsp;<b>pragma</b> ada_95;<br>
        <b>end</b> my_policy;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: A Simple /etc/sparforte_policy file
        </div>
        </div>
        </center>

<h3>Structuring a Script</h3>

<p>Suppose you want to write a script for your project that does something
useful, such as email someone with a "bob" login when there are files
waiting in a certain directory. In SparForte, the following commands can
do the job:</p>

        <center>
        <div class="code">
        <p class="code">num_files : integer := numerics.value( `ls -1 incomingdir | wc -l;` );<br>
	<b>if</b> num_files &gt; 0 <b>then</b><br>
	&nbsp;&nbsp; /bin/echo "There are files waiting in the incoming
	directory" | mail -s "waiting files" bob;<br>
	<b>end</b> <b>if</b>;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: A Simple Unstructured Script
        </div>
        </div>
        </center>

<p>But consider the following questions:</p>

<ul>
  <li>How does the operating system know that this is a SparForte script?</li>
  <li>Is there more than one "mail" command on the computer, which one
executes?</li>
  <li>How does the script inform the program if it succeeds or fails?</li>
  <li>What happens if the ls command was accidentally deleted or
altered by the system administrator (these things happen)?</li>
</ul>

<p>SparForte scripts can be more than a list of commands. SparForte has a number of
features that allow scripts to be "well-structured" (or modular). Well-structured
scripts
are easier to read and debug. Here's an example of a well-structured
SparForte script:</p>

        <center>
        <div class="code">
        <p class="code">
	#!/usr/local/bin/spar<br>
	&nbsp;<br>
	<b>pragma</b> annotate( summary, "checkfiles.sp" )<br>
	&nbsp;&nbsp;@( description, "check the files in the incoming directory and email someone when the files arrive." )<br>
	&nbsp;&nbsp;@( author, "Ken O. Burtch" );<br>
	&nbsp;<br>
	<b>procedure</b> checkfiles is<br>
	-- declarations<br>
	&nbsp; num_files : integer;<br>
	&nbsp; ls : <b>constant</b> command := "/bin/ls"; -- the ls command - man 1 ls<br>
	&nbsp; mail : <b>constant</b> command := "/usr/bin/mail"; -- the mail command - man 1 mail<br>
	<b>begin</b><br>
	&nbsp;<br>
	-- commands begin here<br>
	&nbsp;<br>
	&nbsp; num_files : integer := numerics.value( `ls -1 incomingdir | wc -l;`);<br>
	&nbsp; <b>if</b> num_files &gt; 0 <b>then</b><br>
	&nbsp;&nbsp;&nbsp; /bin/echo "There are files waiting in the incoming directory" | mail -s "waiting files" bob;<br>
	&nbsp; <b>end</b> <b>if</b>;<br>
	&nbsp;<br>
	-- cleanup<br>
	&nbsp;<br>
	&nbsp; command_line.set_exit_status( 0 );<br>
	<b>end</b> checkfiles;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: A Simple Structured Script
        </div>
        </div>
        </center>

<p>The first part of this script is called the <b>header</b>. The header
defines
what kind of script this is, who wrote it, what version it is, and what
restrictions or SparForte pragmas will apply to this script.
</p>
<p>The very first line of a script is the <b>header line</b>. This line begins
with a "#!" at the top of the script, flush with the left margin. This
character combination identifies the kind of script. UNIX-based O/S
uses
this information to start the right program to run the script. For SparForte
scripts, this line contains the absolute pathname to where the SparForte
shell
resides. On many systems, this will be /usr/local/bin/spar.
</p>
<p>If you don't know the location of the SparForte shell, use the "whereis"
command to find it:
</p>

        <center>
        <div class="code">
        <p class="code">=&gt; whereis spar<br>
	spar: /usr/local/bin/spar<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: How to Find the Interpreter's Path
        </div>
        </div>
        </center>

<p>The header line is followed by <b>annotations</b> describing the purpose of
the
script and who wrote it. This is important in case your script needs to
be debugged in an emergency situation.  The <code>help</code> command can
read the annotations in scripts.</p>

        <center>
        <div class="code">
        <p class="code">=&gt; help checkfiles<br>
	Help for script <b>checkfiles.sp</b>:<br>
	&nbsp;<br> 
	Summary: checkfiles.sp<br>
	Description: check the files in the incoming directory and email someone when the files arrive.<br>
	Author: Ken O. Burtch<br>
        </p>
        </div>
        </center>


<p>The <b>main script</b> is wrapped in a procedure statement. The procedure
statement
divides the script into two sections: declaring variables and commands
to run. Putting all the declarations for a script in one place makes it
easy for someone to refer to them while reading the script.
</p>
<p>The commands are declared as <b>command variables</b>. A command variable
is
a special SparForte variable type: when a command variable is declared, SparForte
verifies that the command exists and that it can be run. If the command
cannot be run, SparForte stops the script before any command are executed.
</p>
<p>Without command variables, SparForte searches several directories for the
command you want to run. If it can't find it, the script will stop with
an error after executing part of the script. In this circumstance, it
is
difficult to determine where the script left off and what needs to be
done
to continue. Instead, command variables and other "sanity checks"
should
be put at the top of the script, or in the variable declarations, to
ensure
that when the script fails because of these kind of errors that the
system
will be left in a consistent state.
</p>
<p>After the main portion of the script runs (the part that does the
actual
work), the script should <b>clean up</b> after itself. Any open files should
be
closed or deleted and the script should return a status code to the
person
or program running the script. In this case, there are no files to
clean
up. All that is necessary is the <code>set_exit_status command( 0 )</code> which
indicates
that the script ran successfully.</p>

<h3>Main Procedures</h3>

<p>A <b>subprogram</b> is a piece of a program that is given a name.&nbsp;
Subprograms can be <span style="font-weight: bold;">functions</span>,
routines that return a value for an expression, or <span
 style="font-weight: bold;">procedures</span> that stand alone.&nbsp; A SparForte script
itself can be contained in a <span style="font-weight: bold;">main procedure</span>.<br>
</p>

        <center>
        <div class="code">
        <p class="code">
#!/usr/local/bin/spar<br>
&nbsp;<br>
-- Bottles.sp: A Script implementing a children's song<br>
&nbsp;<br>
<b>procedure</b> Bottles is<br>
<b>begin</b><br>
&nbsp;&nbsp;<b>for</b> X <b>in</b> <b>reverse</b> 1..99 <b>loop</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;? strings.image( X ) &amp; " bottles of beer on the wall";<br>
&nbsp;&nbsp;&nbsp;&nbsp;? strings.image( X ) &amp; " bottles of beer";<br>
&nbsp;&nbsp;&nbsp;&nbsp;? "Take one down, pass it around";<br>
&nbsp;&nbsp;&nbsp;&nbsp;? strings.image( X-1 ) &amp; " bottles of beer on the wall" @ "";<br>
&nbsp;&nbsp;<b>end</b> <b>loop</b>;<br>
<b>end</b> Bottles;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: A Script Enclosed in a Main Procedure Named "Bottles"
        </div>
        </div>
        </center>

<p>In this example, "Bottles" is the main procedure for the script.  Variable
declarations are placed between "is" and "begin" (in this case, there are
none).  Between the "begin" and "end" are the executable statements that
the script will run.</p>

<h3>Procedures and Functions</h3>

<p>Additional procedures and functions can be declared in declared in
the declaration section of the procedure.<br>

        <center>
        <div class="code">
        <p class="code">
#!/usr/local/bin/spar<br>
&nbsp;<br>
-- math1.sp: do some simple math<br>
&nbsp;<br>
<b>procedure</b> math1 <b>is</b><br>
&nbsp;<br>
<b>procedure</b> dotproduct <b>is</b><br>
&nbsp;&nbsp;type vect3 is array(1..3) of integer;<br>
&nbsp;&nbsp;v1 : vect3 := (1,3,-5);<br>
&nbsp;&nbsp;v2 : vect3 := (4,-2,-1);<br>
&nbsp;<br>
&nbsp;&nbsp;sum : integer := 0;<br>
<b>begin</b><br>
&nbsp;&nbsp;<b>for</b> p <b>in</b> arrays.first( v1 )..arrays.last( v1 ) <b>loop</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;sum := @ + v1(p)*v2(p);<br>
&nbsp;&nbsp;<b>end</b> <b>loop</b>;<br>
&nbsp;&nbsp;? sum;<br>
<b>end</b> dotproduct;<br>
&nbsp;<br>
<b>begin</b><br>
&nbsp;&nbsp;  dotproduct;<br>
<b>end</b> math1;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: A Procedure Inside of a Main Procedure
        </div>
        </div>
        </center>
&nbsp;<br>
        <center>
        <div class="code">
        <p class="code">
#!/usr/local/bin/spar<br>
&nbsp;<br>
-- math2.sp: do some simple math<br>
&nbsp;<br>
<b>procedure</b> math2 <b>is</b><br>
&nbsp;<br>
&nbsp; <b>function</b> double( n : integer ) <b>return</b> integer <b>is</b><br>
&nbsp;&nbsp;&nbsp; -- multiply the parameter by two<br>
&nbsp; <b>begin</b><br>
&nbsp;&nbsp;&nbsp; <b>return</b> 2*n;<br>
&nbsp; <b>end</b> double;<br>
&nbsp;<br>
<b>begin</b><br>
&nbsp; put_line( "5 doubled is" &amp; strings.image( double( 5 ) ) );<br>
<b>end</b> math2;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: A Function Inside of a Main Procedure
        </div>
        </div>
        </center>

<p>There is another kind of subprogram, a <b>declare block</b>, that
is discussed in the reference section.</p>

<h3>Designing</h3>

<p>When starting a large project or a project involving more than one
programmer, SparForte has a design mode that is turned on
with the command line option <code>--design</code>.</p>

<p>In design phase mode, you can "spec out" (or create a high level
design) for your project.  You can declaring types, global
variables and empty functions and procedures.  Unfinished items can
be declared using the word <code>abstract</code>,
which means they are not ready for use.  Subprograms that do nothing
are called "stubs".  Using stubs creates a skeleton program that has
enough structure to be tested by SparForte.</p>

        <center>
        <div class="code">
        <p class="code">
#!/usr/local/bin/spar<br>
&nbsp;<br>
<b>procedure</b> design_example <b>is</b><br>
<br>
&nbsp;&nbsp;<b>type</b> customer <b>is</b> <b>new</b> natural;<br>
&nbsp;&nbsp;no_customer : <b>constant</b> customer := 0;<br>
<br>
&nbsp;&nbsp;<b>type</b> supplier <b>is</b> <b>new</b> natural;<br>
&nbsp;&nbsp;no_supplier : <b>constant</b> supplier := 0;<br>
<br>
&nbsp;&nbsp;total : integer;<br>
<br>
&nbsp;&nbsp;<b>function</b> get_customer <b>return</b> customer <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;-- a stub function
<br>
&nbsp;&nbsp;<b>function</b> get_supplier <b>return</b> supplier <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;-- a stub function
<br>
&nbsp;&nbsp;<b>procedure</b> set_customer( c : customer; name : string ) <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;-- a stub function
<br>
&nbsp;&nbsp;<b>procedure</b> set_supplier( s : supplier; name : string ) <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;-- a stub function
<br>
<b>begin</b><br>
&nbsp;&nbsp;<b>null</b>; -- no main program<br>
<b>end</b> design_example;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: Simple Example of Specing Out a Project
        </div>
        </div>
        </center>

<p>This design can be tested with</p>

        <center>
        <div class="code">
        <p class="code">$ spar --design --check design_example.sp</p>
        </div>
        </center>

<p>In design mode, SparForte will focus on design errors and will ignore
errors related to unfinished work.  If no errors are reported, the
design is good.</p>

<p class="plain">While designing, you may have real-world concerns
that impact how you design your project.  For example, you may
have multiple development teams, hardware limitations or quotas,
areas of uncertainty or financial budgets.  There are a set of pragmas
dealing with the design constraints and affinities.  They will alert you if you
have conflicts in your design or if you are over your budget.  These
are especially useful on larger projects as move pieces of source
code from one file to another.  See the
<a href="ref_pragmas.html">pragma reference page</a> for more information.</p>

<p>Explain your unfinished work with
<code>pragma todo</code>, describing
the work owner, effort and priority.  Use this pragma to
generate estimates of the amount of work.</p>

<p>Then run syntax checking to confirm that your overall design is
well-crafted.</p>

        <center>
        <div class="code">
        <p class="code">
#!/usr/local/bin/spar<br>
&nbsp;<br>
<b>procedure</b> design_example <b>is</b><br>

team_awesome : teams.member;

<br>
&nbsp;&nbsp;<b>type</b> customer <b>is</b> <b>new</b> natural;<br>
&nbsp;&nbsp;no_customer : <b>constant</b> customer := 0;<br>
<br>
&nbsp;&nbsp;<b>type</b> supplier <b>is</b> <b>new</b> natural;<br>
&nbsp;&nbsp;no_supplier : <b>constant</b> supplier := 0;<br>
<br>
&nbsp;&nbsp;total : integer;<br>
<br>
&nbsp;&nbsp;<b>function</b> get_customer <b>return</b> customer <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> constraint( optimization, scalability );<br>
&nbsp;&nbsp;<b>pragma</b> constraint( physical, network );<br>
&nbsp;&nbsp;<b>pragma</b> todo( team_awesome, "get_customer", work_measure.story_points, 2, work_priority.severity, 3 );<br>
&nbsp;&nbsp;-- a stub function<br>
<br>
&nbsp;&nbsp;<b>function</b> get_supplier <b>return</b> supplier <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> constraint( optimization, scalability );<br>
&nbsp;&nbsp;<b>pragma</b> constraint( physical, network );<br>
&nbsp;&nbsp;<b>pragma</b> todo( team_awesome, "get_supplier", work_measure.story_points, 2, work_priority.severity, 3 );<br>
&nbsp;&nbsp;-- a stub function<br>
<br>
&nbsp;&nbsp;<b>procedure</b> set_customer( c : customer; name : string ) <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> constraint( optimization, scalability );<br>
&nbsp;&nbsp;<b>pragma</b> constraint( physical, network );<br>
&nbsp;&nbsp;<b>pragma</b> todo( team_awesome, "set_customer", work_measure.story_points, 2, work_priority.severity, 3 );<br>
&nbsp;&nbsp;-- a stub function<br>
<br>
&nbsp;&nbsp;<b>procedure</b> set_supplier( s : supplier; name : string ) <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> constraint( optimization, scalability );<br>
&nbsp;&nbsp;<b>pragma</b> constraint( physical, network );<br>
&nbsp;&nbsp;<b>pragma</b> todo( team_awesome, "set_supplier", work_measure.story_points, 2, work_priority.severity, 3 );<br>
&nbsp;&nbsp;-- a stub function<br>
<br>
<b>begin</b><br>
&nbsp;&nbsp;<b>null</b>; -- no main program<br>
<b>end</b> design_example;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: Simple Example of Design Constraints and Estimating Work
        </div>
        </div>
        </center>

<p>The work report can be created with the <code>help</code> command:</p>

        <center>
        <div class="code">
        <p class="code">
=&gt; help -t design_example<br>
team_awesome,"get_customer",work_measure.story_points, 2,work_priority.severity, 3<br>
team_awesome,"get_supplier",work_measure.story_points, 2,work_priority.severity, 3<br>
team_awesome,"set_customer",work_measure.story_points, 2,work_priority.severity, 3<br>
team_awesome,"set_supplier",work_measure.story_points, 2,work_priority.severity, 3<br>
<br>
Amount of Work<br>
<br>
Story Points: 8<br>
<br>
Priorities of Work<br>
<br>
Severity 3: 4<br>
<br>
Number of To-Do Items: 4</p>
        </div>
        </center>

<p>This is also a good time to choose any architectural pragmas to shape
the design of your project.</p>

<p>If you spec out your project instead of immediately writing executable
code has several advantages:</p>

<ul>
<li>Your team can discuss the overall project and ensure that it meets
all the basic requirements.</li>
<li>Your team can discuss how to organize the project and assign the work.</li>
<li>Team members can start work even if functions and procedure have
not been completed by other team members.</li>
<li>SparForte can verify before you start writing executable code that your design has no errors.</li>
</ul>

<h3>Planning and Estimation</h3>

<p>Whether you are doing waterfall or agile software development, planning
work and estimating time are standard practices.  SparForte
has planning and estimation features that integrate these practices
into your projects.</p>

<p>First, define your team members using teams.member records near
the top of your project.  Also create a team member for the team itself.
This will be used to identify who is working on a task.  If nobody
is working on a task, just assign it to the team.</p>

<p>Use <code>pragma todo</code> to mark places in a program where work needs
to be done.  With this pragma, you can assign the work to a team member,
provide a description and record the estimated effort and the priority of
the work.</p>

        <center>
        <div class="code">
        <p class="code">
team : teams.member;<br>
fred_smith : teams.member;<br>
...<br>
<span style="font-weight: bold;">function</span> get_stock_holdings <span style="font-weight: bold;">return</span> float <span style="font-weight: bold;">is</span><br>
&nbsp;&nbsp;<b>pragma</b> todo( team, "create get_stock_holdings", work_measure.story_points, 5, work_priority.level, 'm' );<br>
<span style="font-weight: bold;">begin</span><br>
&nbsp;&nbsp;<span style="font-weight: bold;">return</span> 0;<br>
<span style="font-weight: bold;">end</span> get_stock_holdings;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <span style="font-weight: bold;">Example</span>: Example of Work Estimation
        </div>
        </div>
        </center>

<p>In this example, get_stock_holdings is stubbed (that is, a place
holder) that hasn't been completed.  It's a medium priority task that
has an estimated effort of 5 story points.  It has been assigned to
the team because no one has started the work.</p>

<p>If Fred Smith starts to work on this function, he assigns it to
himself.  There's a ticket in the work tracking system, so he adds
the ticket id to the pragma.</p>

        <center>
        <div class="code">
        <p class="code">
&nbsp;&nbsp;<b>pragma</b> todo( fred_smith, "create get_stock_holdings", work_measure.story_points, 5, work_priority.level, 'm', "DEV-3742" );</p>
        </div>
        </center>

<p>There are several other work measures and priority types.  You can
choose the one most suited to your project.  SparForte verifies the
syntax, data types and values in the todo.</p>

<p>Once a task is completed, Fred will delete the pragma todo.</p>

<p>In testing or maintenance modes, SparForte will confirm that all todo's
have been completed and the project is ready for release.  (Low priority
tasks can optionally be permitted with <code>pragma suppress</code>).
This way, missing functionality or outstanding bugs are treated
as serious errors, just like serious syntax errors.</p>

<p>The team may be working on a long-term project with interim releases.
In these releases, there will be todo's that are not finished.  In this
case, set the size estimate to unknown.  SparForte will treat these as
tasks that have not been started and will not ignore these for
release purposes.</p>

        <center>
        <div class="code">
        <p class="code">
#!/usr/local/bin/spar<br>
&nbsp;<br>
<b>procedure</b> design_example <b>is</b><br>
<br>
&nbsp;&nbsp;team : teams.member;<br>
&nbsp;&nbsp;-- for this example, all work is assigned to the team<br>
<br>
&nbsp;&nbsp;<b>type</b> customer <b>is</b> <b>new</b> natural;<br>
&nbsp;&nbsp;no_customer : <b>constant</b> customer := 0;<br>
<br>
&nbsp;&nbsp;<b>type</b> supplier <b>is</b> <b>new</b> natural;<br>
&nbsp;&nbsp;no_supplier : <b>constant</b> supplier := 0;<br>
<br>
&nbsp;&nbsp;total : integer;<br>
<br>
&nbsp;&nbsp;<b>function</b> get_customer <b>return</b> customer <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> todo( team,<br>
&nbsp;&nbsp;&nbsp;"get_customer is unfinished",<br>
&nbsp;&nbsp;&nbsp;work_measure.story_points, 2,<br>
&nbsp;&nbsp;&nbsp; work_priority.level, 'm' );<br>
&nbsp;&nbsp;-- a stub function, medium priority, 2 story points of work to complete<br>
<br>
&nbsp;&nbsp;<b>function</b> get_supplier <b>return</b> supplier <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> todo( team,<br>
&nbsp;&nbsp;&nbsp;"get_supplier is unfinished",<br>
&nbsp;&nbsp;&nbsp;work_measure.story_points, 2,<br>
&nbsp;&nbsp;&nbsp; work_priority.level, 'm' );<br>
&nbsp;&nbsp;-- a stub function, medium priority, 2 story points of work to complete<br>
<br>
&nbsp;&nbsp;<b>procedure</b> set_customer( c : customer; name : string ) <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> todo( team,<br>
&nbsp;&nbsp;&nbsp;"set_customer is unfinished",<br>
&nbsp;&nbsp;&nbsp;work_measure.story_points, 3,<br>
&nbsp;&nbsp;&nbsp; work_priority.level, 'm' );<br>
&nbsp;&nbsp;-- a stub function, medium priority, 3 story points of work to complete<br>
<br>
&nbsp;&nbsp;<b>procedure</b> set_supplier( s : supplier; name : string ) <b>is</b> <b>null</b> <b>abstract</b>;<br>
&nbsp;&nbsp;<b>pragma</b> todo( team,<br>
&nbsp;&nbsp;&nbsp;"set_supplier is unfinished",<br>
&nbsp;&nbsp;&nbsp;work_measure.story_points, 3,<br>
&nbsp;&nbsp;&nbsp; work_priority.level, 'm' );<br>
&nbsp;&nbsp;-- a stub function, medium priority, 3 story points of work to complete<br>
<br>
<b>begin</b><br>
&nbsp;&nbsp;<b>pragma</b> todo( team,<br>
&nbsp;&nbsp;&nbsp;"main program is unfinished",<br>
&nbsp;&nbsp;&nbsp;work_measure.story_points, 1,<br>
&nbsp;&nbsp;&nbsp; work_priority.level, 'h' );<br>
&nbsp;&nbsp;-- high priority, 1 story point of work to complete<br>
<b>end</b> design_example;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: Simple Example of Specing Out a Project
        </div>
        </div>
        </center>

<p>The <code>help -t</code> command will scan a project and create an unfinished
work report.  The start of the report is a list of outstanding tasks in
CSV format.  These can
be imported into a spreadsheet or any ticket system supporting CSV
imports.  The end of the report is a summary of the outstanding tasks.
This summary can be used, for example, to create burn-down charts if you
are using Scrum.</p>

        <center>
        <div class="code">
        <p class="code">=&gt; help -t design_example.sp<br>
Help for script t.sp:<br>
<br>
team,"get_customer is unfinished",work_measure.story_points, 2,work_priority.level,m<br>
team,"get_supplier is unfinished",work_measure.story_points, 2,work_priority.level,m<br>
team,"set_customer is unfinished",work_measure.story_points, 3,work_priority.level,m<br>
team,"set_supplier is unfinished",work_measure.story_points, 3,work_priority.level,m<br>
team,"main program is unfinished",work_measure.story_points, 1,work_priority.level,h<br>
<br>
Amount of Work<br>
<br>
Story Points: 11<br>
<br>
Priorities of  Work<br>
<br>
Medium: 4<br>
High: 1<br>
</p>
        </div>
        </center>


<h3>Team Collaboration During Development</h3>

<p>SparForte has features for team communication.  Acting like a messenging
system within the project, team members can propose changes, request
assistance and so forth.  This is particularly useful in open source
projects or teams with geographically remote members.</p>

<p>The <code>help</code> command will display these messages, which can be filtered
with a command like <code>grep</code> and <code>sort</code> to see the ones you are
interested in.</p>

<p>During development, you can suppress test phase mode (the default)
by using <code>--coding</code> or <code>-C</code>.  This will disable unit tests and
will not perform certain tests that assume a program is complete.
There is more on test phase mode below.</p>

<h3>Debugging</h3>

<p>The <code>trace</code> command will show each line of a script as
SparForte reads it.</p>

<p>There are two pragmas for debugging.&nbsp; <code>pragma assert</code> tests for a condition
and stops the script if the condition is false.&nbsp; <code>pragma debug</code> will run a backquoted
command.&nbsp; This debugging statements only run if SparForte is in
debugging mode with the <code>--debug</code> option (or <code>pragma debug</code> with no
parameters).&nbsp; With these pragmas, you won't need to remove
or comment out your debugging statements and risk changing your script's
behaviour.</p>

        <center>
        <div class="code">
        <p class="code">&nbsp; ten : integer := double( 5 );<br>
	&nbsp; <span style="font-weight: bold;">pragma</span> assert( ten = 10 );<br>
	&nbsp; <span style="font-weight: bold;">pragma</span> debug( `put_line( "the value of 10 is" &amp; strings.image( ten ) );` );<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: How To Use Pragma Assert and Debug
        </div>
        </div>
        </center>

<p>To perform more complex debugging, SparForte has a built-in debugger
called the <b>breakout mode</b>.  Using the breakout mode, you can
stop a script at specific points, examine values and more.  You can
find out more about using the debugger in another tutorial.</p>

<p>See the
<a href="tutorial_9.html">Debugging Tutorial</a>
for more info</p>

<h3>Automated Testing</h3>

<p>SparForte has a testing mode which can be turned on with with the
command line option <code>--test</code>. (As of SparForte 2.2.1, testing mode
is the default).</p>

<h4>Source Code Analysis</h4>

<p>In testing mode, SparForte performs an analysis of your script.
If there are any unused identifiers, they will be reported as errors.
While unused variables are always reported, if you are testing, it
is assumed that your design work is complete: testing mode also
report things like unused types, procedures or functions.</p>

<p>If you have specified a software model for your script, SparForte
will check the model's requirements and inform you of any requirements
missing from your script.  See the <code>pragma software_model</code> in the
reference for more information.</p>

<h4>Embedded Tests</h4>

<p>Testing mode runs any <code>pragma assert</code>'s found in your
script.  It also runs any instructions found in <code>pragma test</code>.  These
tests instructions can be used to set up, tear down or run unit tests.
Check the results of your tests with <code>pragma test_result</code>.
Without the <code>--test</code> option, <code>pragma test</code> and
<code>pragma test_assert</code> has no effect.
<code>pragma assert</code> may still have an effect if in debugging mode.</p>

        <center>
        <div class="code">
        <p class="code">&nbsp;<b>procedure</b> test_example <b>is</b><br>
<br>
&nbsp;&nbsp;<b>function</b> two_times( i : integer ) <b>return</b> integer <b>is</b><br>
&nbsp;&nbsp;<b>begin</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>return</b> 2 * i;<br>
&nbsp;&nbsp;<b>end</b> two_times;<br>
<br>
&nbsp;&nbsp;result : integer;<br>
&nbsp;<b>begin</b><br>
&nbsp;&nbsp;<b>null</b>;<br>
<br>
&nbsp;&nbsp;<b>pragma</b> test( `result := two_times( 2 );` );<br>
&nbsp;&nbsp;<b>pragma</b> test_result( result = 4 );<br>
<br>
&nbsp;<b>end</b> test_example;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: One Way To Use Pragma Test and Test Result
        </div>
        </div>
        </center>

<p>If a script is started with the <code>--test</code> (or <code>-t</code>) option,
SparForte runs the script in testing mode.</p>

        <center>
        <div class="code">
        <p class="code">=&gt; spar --test test_example<br>
test_example.sp: 14:   pragma test_result( result = 4 );<br>
^ test failed</p>
        </div>
        </center>

<p>It may not be practical to put all tests in the main script using
pragmas.  This is only a simple example.</p>

<h3>Standards Compliance and Portability</h3>

<p>SparForte scripts can be copied or moved to other tools such as GCC (for binary
applications), JGNAT (JVM applications) or A# (.Net applets).&nbsp; Although
tools like GCC understand most AdaScript features, they have no knowledge of
Bourne shell commands or features only available on SparForte.  The more commands,
pipes and other shell features you use, the more difficult it will be to port
your scripts to other tools.&nbsp; At the same time, these special features
make writing scripts easier.</p>
<p>GCC, JGNAT, A# and SparForte are all designed for compatibility with ISO-standard
Ada.  If your source code needs to be portable, use <code>pragma ada_95</code>.
This pragma will disallow most of the Bourne shell features and will make
your script as compatible as possible with the ISO-standard Ada language.&nbsp;
This does not mean that your script can no longer perform its job but you may
have to rewrite the parts of your script using Ada-friendly features.&nbsp; For example, you will no
longer be able to use the "?" command, a SparForte-specific feature, but you can
rewrite "?" commands to use put_line which is supported by GCC and other Ada-
based tools.  You lose the convenience of some features but gain source code
reusability without a major rewrite of your work.</p>
<p>To further improve the portability of the script, you can turn off
unnecessary features with <code>pragma restriction</code>.&nbsp; For example, pragma
restriction( no_external_commands ) will prevent any external operating system
commands from running.</p>

<p>The final script looks like this.</p>

        <center>
        <div class="code">
        <p class="code">-- math.sp: do some simple math<br>
	&nbsp;<br>
	<span style="font-weight: bold;">procedure</span> math <span style="font-weight: bold;">is</span><br>
	&nbsp;<br>
	&nbsp; <span style="font-weight: bold;">pragma</span> ada_95;<br>
	&nbsp; <span style="font-weight: bold;">pragma</span> restriction( no_external_commands );<br>
	&nbsp; <span style="font-weight: bold;">pragma</span> annotate( "This script
performs some simple math" );<br>
	&nbsp;<br>
	&nbsp; <span style="font-weight: bold;">function</span> double( n : integer ) <span style="font-weight: bold;">return</span> integer <span style="font-weight: bold;">is</span><br>
	&nbsp;&nbsp;&nbsp; -- multiply the parameter by two<br>
	&nbsp; <span style="font-weight: bold;">begin</span><br>
	&nbsp;&nbsp;&nbsp; <span style="font-weight: bold;">return</span> 2*n;<br>
	&nbsp; <span style="font-weight: bold;">end</span> double;<br>
	&nbsp;<br>
	&nbsp; ten : integer := double( 5);<br>
	&nbsp; <span style="font-weight: bold;">pragma</span> assert( ten = 10 );<br>
	&nbsp;<br>
	<span style="font-weight: bold;">begin</span><br>
	&nbsp; put_line( "5 doubled is" &amp; strings.image( ten ) );<br>
	<span style="font-weight: bold;">end</span> math;<br>&nbsp;<br>
        </p>
        <div class="code_caption">
        <b>Example</b>: Our Finished Well-Structured Script
        </div>
        </div>
        </center>

<h3>Retiring a Script</h3>

<p>When a script becomes obsolete, use
<code>pragma deprecated</code>
(or <code>depreciated</code>) to specify name of the new
script which makes the current script obsolete.&nbsp; The old script
will continue to run but when it completes a warning message will
announce that the script is obsolete and SparForte will give the name of the
new script.&nbsp; In this way, old scripts can continue to run as
programmers slowly upgrade to the new script.
</p>

<h3>Study Questions</h3>
<ol>
<li>What are the advantages of doing sanity checks early in a script?</li>
<li>What are the advantages of using a main procedure in a script?</li>
<li>What are the disdvantages of using "pragma ada_95" in a script?</li>
</ol>
&nbsp;<br />

			</td>
			<td bgcolor="#d3c7f8" width="150" align="right" valign="top"><noscript><hr /></noscript><img src="art/right_menu_top.png" width="150" height="24" alt="[Right Submenu]"><br><a name="submenu"></a>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_1.html">&nbsp;Command Prompt Tutorial 1: SparForte as a Calculator</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_2.html">&nbsp;Command Prompt Tutorial 2: Basic Shell Commands</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_3.html">&nbsp;Command Prompt Tutorial 3: Working with Databases</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_4.html">&nbsp;Script Tutorial 1: Basic Commands Scripts</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_5.html">&nbsp;<b>Script Tutorial 2: Intermediate Program Scripts</b></a></p>
				<p class="rmt"><a class="rightmenutext" href="tutorial_14.html">&nbsp;Script Tutorial 3: Data Types</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_6.html">&nbsp;Template Tutorial 1: Basic Templates</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_7.html">&nbsp;Template Tutorial 2: Intermediate Templates</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_8.html">&nbsp;GCC Tutorial: Compiling SparForte Scripts</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_9.html">&nbsp;Debugging Tutorial - Using the SparForte Debugger</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_10.html">&nbsp;Creating a Profile Script</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_11.html">&nbsp;Calling SparForte from C: A Tutorial</a></p>
				<p class="rmt"><a class="rightmenutext" href="tutorial_13.html">&nbsp;SparForte For PHP Developers</a></p>
                                <p class="rmt"><a class="rightmenutext" href="tutorial_12.html">&nbsp;SparForte Best Practices</a></p>
			</td>
		</tr>
		<tr>
			<td bgcolor="#d3c7f8" align="left" valign="middle"><a href="#top"><img src="art/up_arrow.png" width="24" height="27" border="0" alt="[Back to Top]"><span>&nbsp;Back To Top</span></a></td>
			<td bgcolor="#d3c7f8" align="center" valign="middle"><img src="art/forte_small.png" width="26" height="32" border="0" alt="[Small Forte Symbol]"></td>
	       	</tr>

	</table>

</body>
</html>
